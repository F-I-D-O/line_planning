This repository contains code to replicate experiments in: 'Real-Time Approximate Routing for Smart Transit Systems' URL: https://arxiv.org/abs/2103.06212

Usage instructions: to replicate experiments for the Manhattan network (table 2 in the paper):

1) Download all files and unzip files manhattan_dist_1.txt, manhattan_dist_2.txt and manhattan_dist_3.txt
2) Run line_planning.py.

The experiments run by default using trip request from April 3rd 2018. To run the experiments for the fhv data from Feb 3 or March 6, uncomment the parameter 'month' line #407 in the file line_instance.py.

The code allows to test both our algorithm and the ILP solver for different values of the budget and with a time limit of 1200s. The candidate set of lines has been pregenerated and is stored in the file 'all_lines_1000_c5.txt'. The code used to generate the lines can be found in the file instance.py.

# Input Files
There are three groups of input files: 

- **Distance Matrix Files**: That are combined to create a single distance matrix.
    - `manhattan_dist_1.txt`, `manhattan_dist_2.txt`, `manhattan_dist_3.txt`
    - compressed in repo (zip)
- **Demand files**: That contain the OD matrix.
    - `OD_matrix_april_fhv.txt`, `OD_matrix_feb_fhv.txt`, `OD_matrix_march_fhv.txt`
- **Line files**: That contain the candidate set of lines.
    - `all_lines_1000_c5.txt`, `all_lines_nodes_1000_c5.txt`, `all_routes_1000_c5.txt`

## Line Files

- `all_lines_1000_c5.txt`: Contains the pre-generated candidate set of 1000 transit lines for the Manhattan network. Each line represents a sequence of node IDs that form a potential transit route. This file is generated by the code in `instance.py` and contains the actual node IDs from the Manhattan network.
- `all_lines_nodes_1000_c5.txt`: Contains the same candidate set of lines but with node indices (0 to 4579) instead of actual node IDs. **This is the file actually loaded by the algorithm** (`my_list = [line.split(' ') for line in open('all_lines_nodes_1000_c5.txt')]`).
- `all_routes_1000_c5.txt`: Contains the detailed route information for each line, including intermediate nodes along the path between stops. This provides the complete path that vehicles would follow on each transit line.





